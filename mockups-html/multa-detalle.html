<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Detalle de Multa #M-2024-089 - Cuentas Claras</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Flatpickr CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Tokens / overrides -->
    <link href="assets/css/style.css" rel="stylesheet">
    <style>
      /* Mobile-first Styles */
      .nav-sidebar .nav-item .nav-link { color: rgba(255,255,255,0.8); }
      .nav-sidebar .nav-item .nav-link:hover { color: #fff; background-color: rgba(255,255,255,0.1); }
      .nav-sidebar .nav-item .nav-link.active { 
        color: #fff; 
        background: rgba(253,93,20,0.2);
        border-left: 3px solid var(--color-accent);
      }
      .nav-sidebar .nav-item .nav-link.active .material-icons { color: var(--color-accent); }
      
      .sidebar {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
        z-index: 1000;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        width: 280px;
      }
      
      .sidebar.show {
        transform: translateX(0);
      }
      
      .sidebar-backdrop {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 999;
        background-color: rgba(0,0,0,0.5);
        display: none;
      }
      
      .sidebar-backdrop.show {
        display: block;
      }
      
      @media (min-width: 992px) {
        .sidebar {
          transform: translateX(0);
        }
        
        .main-content {
          margin-left: 280px;
        }
        
        .toggle-sidebar {
          display: none;
        }
      }
      
      .avatar {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-primary);
        color: #fff;
        font-weight: bold;
        border-radius: 50%;
      }
      
      /* Fine status */
      .fine-status {
        display: inline-flex;
        align-items: center;
        padding: 0.5rem 1rem;
        border-radius: 2rem;
        font-size: 0.875rem;
        font-weight: 500;
        margin-bottom: 1rem;
      }
      
      .fine-status.pending {
        background-color: #FFF8E1;
        color: #F57F17;
        border: 1px solid #FFEB3B;
      }
      
      .fine-status.paid {
        background-color: #E8F5E9;
        color: #2E7D32;
        border: 1px solid #4CAF50;
      }
      
      .fine-status.overdue {
        background-color: #FFEBEE;
        color: #C62828;
        border: 1px solid #F44336;
      }
      
      .fine-status.appealed {
        background-color: #F3E5F5;
        color: #7B1FA2;
        border: 1px solid #9C27B0;
      }
      
      .fine-status.cancelled {
        background-color: #F5F5F5;
        color: #757575;
        border: 1px solid #9E9E9E;
      }
      
      /* Info cards */
      .info-card {
        background-color: #fff;
        border-radius: var(--radius);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: var(--shadow-sm);
        border: 1px solid #e9ecef;
      }
      
      .info-card-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: #212529;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid #e9ecef;
        display: flex;
        align-items: center;
      }
      
      .info-card-title .material-icons {
        margin-right: 0.5rem;
        color: var(--color-primary);
      }
      
      .info-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem 0;
        border-bottom: 1px solid #f8f9fa;
      }
      
      .info-item:last-child {
        border-bottom: none;
      }
      
      .info-label {
        font-weight: 500;
        color: #6c757d;
      }
      
      .info-value {
        font-weight: 600;
        color: #212529;
        text-align: right;
      }
      
      /* Tabs */
      .nav-tabs .nav-link {
        border: none;
        color: #6c757d;
        font-weight: 500;
        padding: 1rem 1.5rem;
        margin-right: 0.5rem;
        border-radius: 0.5rem 0.5rem 0 0;
      }
      
      .nav-tabs .nav-link:hover {
        border: none;
        background-color: rgba(253,93,20,0.05);
        color: var(--color-primary);
      }
      
      .nav-tabs .nav-link.active {
        background-color: #fff;
        color: var(--color-primary);
        border: 1px solid #e9ecef;
        border-bottom: 1px solid #fff;
        margin-bottom: -1px;
      }
      
      .tab-content {
        background-color: #fff;
        border: 1px solid #e9ecef;
        border-radius: 0 0.5rem 0.5rem 0.5rem;
        padding: 1.5rem;
        box-shadow: var(--shadow-sm);
      }
      
      /* Timeline */
      .timeline {
        position: relative;
        padding-left: 2rem;
      }
      
      .timeline::before {
        content: '';
        position: absolute;
        left: 0.75rem;
        top: 0;
        bottom: 0;
        width: 2px;
        background-color: #e9ecef;
      }
      
      .timeline-item {
        position: relative;
        margin-bottom: 1.5rem;
      }
      
      .timeline-item::before {
        content: '';
        position: absolute;
        left: -0.5rem;
        top: 0.5rem;
        width: 1rem;
        height: 1rem;
        border-radius: 50%;
        background-color: var(--color-primary);
      }
      
      .timeline-item.success::before {
        background-color: #28a745;
      }
      
      .timeline-item.warning::before {
        background-color: #ffc107;
      }
      
      .timeline-item.danger::before {
        background-color: #dc3545;
      }
      
      .timeline-content {
        background-color: #f8f9fa;
        padding: 1rem;
        border-radius: var(--radius);
        border-left: 3px solid var(--color-primary);
      }
      
      .timeline-item.success .timeline-content {
        border-left-color: #28a745;
      }
      
      .timeline-item.warning .timeline-content {
        border-left-color: #ffc107;
      }
      
      .timeline-item.danger .timeline-content {
        border-left-color: #dc3545;
      }
      
      .timeline-date {
        font-size: 0.875rem;
        color: #6c757d;
        margin-bottom: 0.25rem;
      }
      
      .timeline-title {
        font-weight: 600;
        color: #212529;
        margin-bottom: 0.25rem;
      }
      
      .timeline-description {
        color: #495057;
        margin-bottom: 0;
      }
      
      /* Evidence gallery */
      .evidence-item {
        position: relative;
        border-radius: var(--radius);
        overflow: hidden;
        cursor: pointer;
        transition: transform 0.2s ease;
      }
      
      .evidence-item:hover {
        transform: scale(1.05);
      }
      
      .evidence-item img {
        width: 100%;
        height: 150px;
        object-fit: cover;
      }
      
      .evidence-item .evidence-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0,0,0,0.7));
        color: white;
        padding: 0.5rem;
        font-size: 0.875rem;
      }
      
      /* Payment history */
      .payment-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        background-color: #f8f9fa;
        border-radius: var(--radius);
        margin-bottom: 1rem;
        border-left: 4px solid #28a745;
      }
      
      .payment-info {
        flex-grow: 1;
      }
      
      .payment-date {
        font-weight: 600;
        color: #212529;
      }
      
      .payment-method {
        font-size: 0.875rem;
        color: #6c757d;
      }
      
      .payment-amount {
        font-size: 1.25rem;
        font-weight: bold;
        color: #28a745;
      }
      
      /* Appeal section */
      .appeal-section {
        background-color: #f3e5f5;
        border: 1px solid #ce93d8;
        border-radius: var(--radius);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }
      
      .appeal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }
      
      .appeal-status {
        padding: 0.25rem 0.75rem;
        border-radius: 1rem;
        font-size: 0.875rem;
        font-weight: 500;
        background-color: #7b1fa2;
        color: white;
      }
      
      /* Communication section */
      .communication-item {
        border: 1px solid #e9ecef;
        border-radius: var(--radius);
        padding: 1rem;
        margin-bottom: 1rem;
      }
      
      .communication-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
      }
      
      .communication-type {
        display: inline-flex;
        align-items: center;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
        font-weight: 500;
      }
      
      .communication-type.email {
        background-color: #e3f2fd;
        color: #1565c0;
      }
      
      .communication-type.sms {
        background-color: #e8f5e9;
        color: #2e7d32;
      }
      
      .communication-type.notification {
        background-color: #fff8e1;
        color: #f57f17;
      }
      
      /* Action buttons */
      .action-button {
        border: none;
        border-radius: var(--radius);
        padding: 0.75rem 1.5rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        text-decoration: none;
      }
      
      .action-button .material-icons {
        margin-right: 0.5rem;
        font-size: 1.1rem;
      }
      
      .action-button.primary {
        background-color: var(--color-primary);
        color: white;
      }
      
      .action-button.primary:hover {
        background-color: #e85a14;
        color: white;
      }
      
      .action-button.success {
        background-color: #28a745;
        color: white;
      }
      
      .action-button.success:hover {
        background-color: #218838;
        color: white;
      }
      
      .action-button.warning {
        background-color: #ffc107;
        color: #212529;
      }
      
      .action-button.warning:hover {
        background-color: #e0a800;
        color: #212529;
      }
      
      .action-button.danger {
        background-color: #dc3545;
        color: white;
      }
      
      .action-button.danger:hover {
        background-color: #c82333;
        color: white;
      }
    </style>
  </head>
  <body>
    <div class="d-flex">
      <!-- Sidebar -->
      <div class="sidebar d-flex flex-column flex-shrink-0 p-3 text-white bg-dark" style="background: linear-gradient(180deg, var(--color-primary) 0%, #071a38 100%) !important;">
        <a href="dashboard.html" class="d-flex align-items-center text-white text-decoration-none mb-4">
          <span class="material-icons me-2" style="font-size: 32px;">apartment</span>
          <span class="fs-4">Cuentas Claras</span>
        </a>
        
        <div class="d-flex align-items-center mb-3 px-2">
          <div class="avatar me-2" style="background-color: var(--color-accent);">PC</div>
          <div>
            <span class="d-block text-white">Patricia Contreras</span>
            <span class="small text-white-50">Administradora</span>
          </div>
        </div>
        
        <hr>
        
        <ul class="nav nav-sidebar flex-column mb-auto">
          <li class="nav-item">
            <a href="dashboard.html" class="nav-link px-3 py-2 mb-1">
              <span class="material-icons align-middle me-2">dashboard</span>
              <span>Dashboard</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="comunidades-listado.html" class="nav-link px-3 py-2 mb-1">
              <span class="material-icons align-middle me-2">domain</span>
              <span>Comunidades</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="unidades-listado.html" class="nav-link px-3 py-2 mb-1">
              <span class="material-icons align-middle me-2">apartment</span>
              <span>Unidades</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="personas-listado.html" class="nav-link px-3 py-2 mb-1">
              <span class="material-icons align-middle me-2">people</span>
              <span>Personas</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="medidores-listado.html" class="nav-link px-3 py-2 mb-1">
              <span class="material-icons align-middle me-2">speed</span>
              <span>Medidores</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="multas-listado.html" class="nav-link active px-3 py-2 mb-1">
              <span class="material-icons align-middle me-2">gavel</span>
              <span>Multas</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="emisiones-listado.html" class="nav-link px-3 py-2 mb-1">
              <span class="material-icons align-middle me-2">receipt_long</span>
              <span>Emisiones</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="gastos-listado.html" class="nav-link px-3 py-2 mb-1">
              <span class="material-icons align-middle me-2">money_off</span>
              <span>Gastos</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="reportes-dashboard.html" class="nav-link px-3 py-2 mb-1">
              <span class="material-icons align-middle me-2">bar_chart</span>
              <span>Reportes</span>
            </a>
          </li>
        </ul>
        
        <hr>
        
        <div class="dropdown">
          <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" id="userDropdown" data-bs-toggle="dropdown">
            <span class="material-icons me-2">settings</span>
            <span>Configuración</span>
          </a>
          <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="userDropdown">
            <li><a class="dropdown-item" href="profile.html">Mi Perfil</a></li>
            <li><a class="dropdown-item" href="#">Configuración</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item text-danger" href="login.html">Cerrar Sesión</a></li>
          </ul>
        </div>
      </div>
      
      <!-- Sidebar backdrop for mobile -->
      <div class="sidebar-backdrop" onclick="toggleSidebar()"></div>
      
      <!-- Contenido principal -->
      <div class="main-content flex-grow-1 bg-light">
        <!-- Header con búsqueda y notificaciones -->
        <header class="bg-white border-bottom shadow-sm p-3">
          <div class="container-fluid">
            <div class="row align-items-center">
              <div class="col-lg-6">
                <button class="btn toggle-sidebar d-lg-none me-2" onclick="toggleSidebar()">
                  <span class="material-icons">menu</span>
                </button>
                <div class="d-flex align-items-center">
                  <a href="multas-listado.html" class="text-decoration-none text-muted me-2">
                    <span class="material-icons">arrow_back</span>
                  </a>
                  <div>
                    <h5 class="mb-0">Multa #M-2024-089</h5>
                    <small class="text-muted">Torre Norte - Unidad 4A • Ruidos molestos</small>
                  </div>
                </div>
              </div>
              
              <div class="col-lg-6">
                <div class="d-flex justify-content-end align-items-center">
                  <div class="me-3">
                    <button class="btn position-relative p-0" type="button" data-bs-toggle="dropdown">
                      <span class="material-icons">notifications</span>
                      <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                        3
                      </span>
                    </button>
                  </div>
                  
                  <div class="dropdown">
                    <a href="#" class="d-flex align-items-center text-dark text-decoration-none dropdown-toggle" id="userMenu" data-bs-toggle="dropdown" aria-expanded="false">
                      <div class="avatar me-2" style="background-color: var(--color-accent);">PC</div>
                      <div class="d-none d-sm-block">
                        <div class="fw-bold">Patricia Contreras</div>
                        <small class="text-muted">Administradora</small>
                      </div>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu">
                      <li><a class="dropdown-item" href="profile.html">Mi Perfil</a></li>
                      <li><a class="dropdown-item" href="#">Configuración</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item text-danger" href="login.html">Cerrar Sesión</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </header>

        <!-- Contenido -->
        <main class="container-fluid p-4">
          <div class="row">
            <!-- Columna principal -->
            <div class="col-lg-8">
              <!-- Encabezado con estado -->
              <div class="d-flex justify-content-between align-items-start mb-4">
                <div>
                  <div class="fine-status pending">
                    <span class="material-icons me-2">schedule</span>
                    Pendiente de Pago
                  </div>
                  <h2 class="h4 mb-1">Multa por Ruidos Molestos</h2>
                  <p class="text-muted mb-0">Emitida el 10/09/2024 • Vence el 25/09/2024</p>
                </div>
                <div class="text-end">
                  <div class="h3 mb-0 text-primary">$85.000</div>
                  <small class="text-muted">Monto a pagar</small>
                </div>
              </div>

              <!-- Botones de acción -->
              <div class="d-flex flex-wrap gap-2 mb-4">
                <button class="action-button success" data-bs-toggle="modal" data-bs-target="#paymentModal">
                  <span class="material-icons">payment</span>
                  Registrar Pago
                </button>
                <button class="action-button warning" onclick="sendReminder()">
                  <span class="material-icons">mail</span>
                  Enviar Recordatorio
                </button>
                <button class="action-button primary" data-bs-toggle="modal" data-bs-target="#editModal">
                  <span class="material-icons">edit</span>
                  Editar Multa
                </button>
                <button class="action-button danger" onclick="cancelFine()">
                  <span class="material-icons">cancel</span>
                  Anular Multa
                </button>
              </div>

              <!-- Tabs -->
              <ul class="nav nav-tabs" id="fineDetailTabs" role="tablist">
                <li class="nav-item" role="presentation">
                  <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">
                    <span class="material-icons me-2">info</span>
                    Información General
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="evidence-tab" data-bs-toggle="tab" data-bs-target="#evidence" type="button" role="tab">
                    <span class="material-icons me-2">attach_file</span>
                    Evidencia
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="payments-tab" data-bs-toggle="tab" data-bs-target="#payments" type="button" role="tab">
                    <span class="material-icons me-2">payment</span>
                    Pagos
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="appeals-tab" data-bs-toggle="tab" data-bs-target="#appeals" type="button" role="tab">
                    <span class="material-icons me-2">gavel</span>
                    Apelaciones
                  </button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="communications-tab" data-bs-toggle="tab" data-bs-target="#communications" type="button" role="tab">
                    <span class="material-icons me-2">message</span>
                    Comunicaciones
                  </button>
                </li>
              </ul>

              <div class="tab-content" id="fineDetailTabsContent">
                <!-- Información General -->
                <div class="tab-pane fade show active" id="overview" role="tabpanel">
                  <div class="row">
                    <div class="col-md-6">
                      <h6 class="mb-3">Detalles de la Infracción</h6>
                      <div class="info-item">
                        <span class="info-label">Fecha y Hora:</span>
                        <span class="info-value">10/09/2024 - 23:30</span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Ubicación:</span>
                        <span class="info-value">Unidad 4A - Torre Norte</span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Tipo de Infracción:</span>
                        <span class="info-value">Ruidos molestos en horario de descanso</span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Reportado por:</span>
                        <span class="info-value">Conserje nocturno</span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Prioridad:</span>
                        <span class="info-value">
                          <span class="badge bg-warning">Media</span>
                        </span>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <h6 class="mb-3">Información del Pago</h6>
                      <div class="info-item">
                        <span class="info-label">Monto Base:</span>
                        <span class="info-value">$85.000</span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Recargos:</span>
                        <span class="info-value">$0</span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Total a Pagar:</span>
                        <span class="info-value"><strong>$85.000</strong></span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Fecha de Vencimiento:</span>
                        <span class="info-value">25/09/2024</span>
                      </div>
                      <div class="info-item">
                        <span class="info-label">Días Restantes:</span>
                        <span class="info-value text-warning"><strong>10 días</strong></span>
                      </div>
                    </div>
                  </div>
                  
                  <div class="mt-4">
                    <h6 class="mb-3">Descripción Detallada</h6>
                    <div class="bg-light p-3 rounded">
                      <p class="mb-0">
                        Según reporte del conserje nocturno, se registraron ruidos molestos provenientes de la unidad 4A durante 
                        el horario de descanso establecido en el reglamento (22:00 - 08:00). Los ruidos consistían en música a 
                        alto volumen y voces que se escuchaban desde el pasillo. Se realizaron dos llamadas de atención verbales 
                        sin obtener respuesta antes de proceder con la multa.
                      </p>
                    </div>
                  </div>
                  
                  <div class="mt-4">
                    <h6 class="mb-3">Notas Internas</h6>
                    <div class="bg-light p-3 rounded">
                      <p class="mb-0">
                        <strong>Administrador:</strong> Segunda infracción del mismo tipo en 3 meses. 
                        Considerar seguimiento adicional si persiste el comportamiento.
                      </p>
                    </div>
                  </div>
                </div>

                <!-- Evidencia -->
                <div class="tab-pane fade" id="evidence" role="tabpanel">
                  <h6 class="mb-3">Evidencia Adjunta</h6>
                  <div class="row">
                    <div class="col-md-4 mb-3">
                      <div class="evidence-item">
                        <img src="https://via.placeholder.com/300x200/e9ecef/6c757d?text=Foto+1" alt="Evidencia 1">
                        <div class="evidence-overlay">
                          <div>reporte_conserje_1.jpg</div>
                          <small>Subido: 10/09/2024 23:45</small>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <div class="evidence-item">
                        <img src="https://via.placeholder.com/300x200/e9ecef/6c757d?text=Foto+2" alt="Evidencia 2">
                        <div class="evidence-overlay">
                          <div>reporte_conserje_2.jpg</div>
                          <small>Subido: 10/09/2024 23:47</small>
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4 mb-3">
                      <div class="evidence-item">
                        <div class="d-flex align-items-center justify-content-center bg-light" style="height: 150px;">
                          <div class="text-center">
                            <span class="material-icons text-muted mb-2" style="font-size: 2rem;">description</span>
                            <div>reglamento_interno.pdf</div>
                            <small class="text-muted">Referencia legal</small>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="mt-4">
                    <button class="btn btn-outline-primary" onclick="addEvidence()">
                      <span class="material-icons me-2">add</span>
                      Agregar Evidencia
                    </button>
                  </div>
                </div>

                <!-- Historial de Pagos -->
                <div class="tab-pane fade" id="payments" role="tabpanel">
                  <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="mb-0">Historial de Pagos</h6>
                    <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#paymentModal">
                      <span class="material-icons me-1">add</span>
                      Registrar Pago
                    </button>
                  </div>
                  
                  <div class="alert alert-info">
                    <span class="material-icons me-2">info</span>
                    <strong>Sin pagos registrados.</strong> Esta multa aún no ha sido pagada.
                  </div>
                  
                  <div class="bg-light p-3 rounded">
                    <h6>Información de Pago</h6>
                    <div class="row">
                      <div class="col-md-6">
                        <p><strong>Monto Total:</strong> $85.000</p>
                        <p><strong>Fecha de Vencimiento:</strong> 25/09/2024</p>
                      </div>
                      <div class="col-md-6">
                        <p><strong>Días para Vencimiento:</strong> 10 días</p>
                        <p><strong>Recargo por Atraso:</strong> 5% después del vencimiento</p>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Apelaciones -->
                <div class="tab-pane fade" id="appeals" role="tabpanel">
                  <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="mb-0">Historial de Apelaciones</h6>
                  </div>
                  
                  <div class="alert alert-secondary">
                    <span class="material-icons me-2">info</span>
                    <strong>Sin apelaciones presentadas.</strong> Esta multa no ha sido apelada.
                  </div>
                  
                  <div class="bg-light p-3 rounded">
                    <h6>Información sobre Apelaciones</h6>
                    <ul class="mb-0">
                      <li>El residente tiene derecho a apelar dentro de 15 días de emitida la multa</li>
                      <li>La apelación debe presentarse por escrito con la evidencia correspondiente</li>
                      <li>El administrador tiene 10 días hábiles para responder</li>
                      <li>Plazo de apelación: hasta el 25/09/2024</li>
                    </ul>
                  </div>
                </div>

                <!-- Comunicaciones -->
                <div class="tab-pane fade" id="communications" role="tabpanel">
                  <div class="d-flex justify-content-between align-items-center mb-3">
                    <h6 class="mb-0">Historial de Comunicaciones</h6>
                    <button class="btn btn-primary btn-sm" onclick="sendCommunication()">
                      <span class="material-icons me-1">send</span>
                      Enviar Comunicación
                    </button>
                  </div>
                  
                  <div class="communication-item">
                    <div class="communication-header">
                      <div>
                        <span class="communication-type notification">Notificación</span>
                        <span class="ms-2 fw-bold">Multa Emitida</span>
                      </div>
                      <small class="text-muted">10/09/2024 09:00</small>
                    </div>
                    <p class="mb-0">Notificación automática enviada al residente informando sobre la multa por ruidos molestos.</p>
                  </div>
                  
                  <div class="communication-item">
                    <div class="communication-header">
                      <div>
                        <span class="communication-type email">Email</span>
                        <span class="ms-2 fw-bold">Notificación de Multa</span>
                      </div>
                      <small class="text-muted">10/09/2024 09:15</small>
                    </div>
                    <p class="mb-2">Email enviado a: maria.gonzalez@email.com</p>
                    <p class="mb-0"><strong>Estado:</strong> <span class="text-success">Entregado</span></p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Columna lateral -->
            <div class="col-lg-4">
              <!-- Información de la Unidad -->
              <div class="info-card">
                <div class="info-card-title">
                  <span class="material-icons">apartment</span>
                  Información de la Unidad
                </div>
                <div class="info-item">
                  <span class="info-label">Unidad:</span>
                  <span class="info-value">Torre Norte - 4A</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Propietario:</span>
                  <span class="info-value">María González</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Email:</span>
                  <span class="info-value">maria.gonzalez@email.com</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Teléfono:</span>
                  <span class="info-value">+56 9 8765 4321</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Tipo:</span>
                  <span class="info-value">Propietario residente</span>
                </div>
                <div class="mt-3">
                  <a href="unidad-detalle.html" class="btn btn-outline-primary btn-sm w-100">
                    <span class="material-icons me-1">visibility</span>
                    Ver Detalle de Unidad
                  </a>
                </div>
              </div>

              <!-- Estadísticas de Multas -->
              <div class="info-card">
                <div class="info-card-title">
                  <span class="material-icons">analytics</span>
                  Historial de Multas
                </div>
                <div class="info-item">
                  <span class="info-label">Total Multas:</span>
                  <span class="info-value">3</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Multas Pagadas:</span>
                  <span class="info-value text-success">1</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Multas Pendientes:</span>
                  <span class="info-value text-warning">2</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Monto Total Pendiente:</span>
                  <span class="info-value text-danger">$170.000</span>
                </div>
                <div class="info-item">
                  <span class="info-label">Última Multa:</span>
                  <span class="info-value">10/09/2024</span>
                </div>
              </div>

              <!-- Timeline de Actividades -->
              <div class="info-card">
                <div class="info-card-title">
                  <span class="material-icons">timeline</span>
                  Actividades Recientes
                </div>
                <div class="timeline">
                  <div class="timeline-item">
                    <div class="timeline-content">
                      <div class="timeline-date">10/09/2024 - 23:45</div>
                      <div class="timeline-title">Multa Emitida</div>
                      <div class="timeline-description">Se emite multa por ruidos molestos</div>
                    </div>
                  </div>
                  <div class="timeline-item">
                    <div class="timeline-content">
                      <div class="timeline-date">10/09/2024 - 09:15</div>
                      <div class="timeline-title">Notificación Enviada</div>
                      <div class="timeline-description">Email de notificación entregado</div>
                    </div>
                  </div>
                  <div class="timeline-item warning">
                    <div class="timeline-content">
                      <div class="timeline-date">10/09/2024 - 23:30</div>
                      <div class="timeline-title">Infracción Reportada</div>
                      <div class="timeline-description">Conserje reporta ruidos molestos</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- Modal para registrar pago -->
    <div class="modal fade" id="paymentModal" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Registrar Pago - Multa #M-2024-089</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="paymentAmount" class="form-label">Monto Pagado *</label>
                <div class="input-group">
                  <span class="input-group-text">$</span>
                  <input type="number" class="form-control" id="paymentAmount" value="85000" required>
                </div>
              </div>
              <div class="mb-3">
                <label for="paymentDate" class="form-label">Fecha de Pago *</label>
                <input type="text" class="form-control flatpickr" id="paymentDate" placeholder="Seleccionar fecha" required>
              </div>
              <div class="mb-3">
                <label for="paymentMethod" class="form-label">Método de Pago *</label>
                <select class="form-select" id="paymentMethod" required>
                  <option value="">Seleccionar método</option>
                  <option value="cash">Efectivo</option>
                  <option value="transfer">Transferencia bancaria</option>
                  <option value="check">Cheque</option>
                  <option value="card">Tarjeta de débito/crédito</option>
                  <option value="online">Pago en línea</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="paymentReference" class="form-label">Número de Comprobante</label>
                <input type="text" class="form-control" id="paymentReference" placeholder="Número de transacción o comprobante">
              </div>
              <div class="mb-3">
                <label for="paymentNotes" class="form-label">Observaciones</label>
                <textarea class="form-control" id="paymentNotes" rows="3" placeholder="Observaciones adicionales sobre el pago..."></textarea>
              </div>
              <div class="mb-3">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="sendPaymentConfirmation" checked>
                  <label class="form-check-label" for="sendPaymentConfirmation">
                    Enviar confirmación de pago al residente
                  </label>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-success" onclick="registerPayment()">
              <span class="material-icons me-1">payment</span>
              Registrar Pago
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal para editar multa -->
    <div class="modal fade" id="editModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Editar Multa #M-2024-089</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="editViolationDate" class="form-label">Fecha de Infracción</label>
                  <input type="text" class="form-control flatpickr" id="editViolationDate" value="10/09/2024">
                </div>
                <div class="col-md-6 mb-3">
                  <label for="editAmount" class="form-label">Monto de la Multa</label>
                  <div class="input-group">
                    <span class="input-group-text">$</span>
                    <input type="number" class="form-control" id="editAmount" value="85000">
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label for="editDescription" class="form-label">Descripción</label>
                <textarea class="form-control" id="editDescription" rows="4">Según reporte del conserje nocturno, se registraron ruidos molestos provenientes de la unidad 4A durante el horario de descanso establecido en el reglamento (22:00 - 08:00). Los ruidos consistían en música a alto volumen y voces que se escuchaban desde el pasillo. Se realizaron dos llamadas de atención verbales sin obtener respuesta antes de proceder con la multa.</textarea>
              </div>
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="editDueDate" class="form-label">Fecha de Vencimiento</label>
                  <input type="text" class="form-control flatpickr" id="editDueDate" value="25/09/2024">
                </div>
                <div class="col-md-6 mb-3">
                  <label for="editPriority" class="form-label">Prioridad</label>
                  <select class="form-select" id="editPriority">
                    <option value="low">Baja</option>
                    <option value="medium" selected>Media</option>
                    <option value="high">Alta</option>
                  </select>
                </div>
              </div>
              <div class="mb-3">
                <label for="editInternalNotes" class="form-label">Notas Internas</label>
                <textarea class="form-control" id="editInternalNotes" rows="3">Segunda infracción del mismo tipo en 3 meses. Considerar seguimiento adicional si persiste el comportamiento.</textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary" onclick="updateFine()">
              <span class="material-icons me-1">save</span>
              Guardar Cambios
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Flatpickr JS -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
    <script src="assets/js/script.js"></script>
    <script>
      function toggleSidebar() {
        const sidebar = document.querySelector('.sidebar');
        const backdrop = document.querySelector('.sidebar-backdrop');
        
        sidebar.classList.toggle('show');
        backdrop.classList.toggle('show');
      }

      // Initialize Flatpickr
      document.addEventListener('DOMContentLoaded', function() {
        flatpickr('.flatpickr', {
          locale: 'es',
          dateFormat: 'd/m/Y',
          allowInput: true
        });
      });

      // Evidence gallery
      document.querySelectorAll('.evidence-item').forEach(item => {
        item.addEventListener('click', function() {
          const img = this.querySelector('img');
          if (img) {
            // In a real app, this would open a modal or lightbox
            window.open(img.src, '_blank');
          }
        });
      });

      function sendReminder() {
        if (confirm('¿Enviar recordatorio de pago al residente?')) {
          // Simulate sending reminder
          setTimeout(() => {
            alert('Recordatorio enviado exitosamente');
            // Add communication entry
            addCommunicationEntry('Recordatorio de Pago', 'email', 'Email de recordatorio enviado');
          }, 1000);
        }
      }

      function cancelFine() {
        if (confirm('¿Estás seguro de que deseas anular esta multa? Esta acción no se puede deshacer.')) {
          // Simulate cancellation
          setTimeout(() => {
            alert('Multa anulada exitosamente');
            location.href = 'multas-listado.html';
          }, 1000);
        }
      }

      function registerPayment() {
        const amount = document.getElementById('paymentAmount').value;
        const date = document.getElementById('paymentDate').value;
        const method = document.getElementById('paymentMethod').value;
        
        if (!amount || !date || !method) {
          alert('Por favor completa todos los campos obligatorios');
          return;
        }
        
        // Simulate payment registration
        setTimeout(() => {
          alert('Pago registrado exitosamente');
          location.reload();
        }, 1000);
      }

      function updateFine() {
        // Simulate update
        setTimeout(() => {
          alert('Multa actualizada exitosamente');
          location.reload();
        }, 1000);
      }

      function addEvidence() {
        const input = document.createElement('input');
        input.type = 'file';
        input.multiple = true;
        input.accept = 'image/*,video/*,.pdf,.doc,.docx';
        input.onchange = function(e) {
          const files = Array.from(e.target.files);
          if (files.length > 0) {
            alert(`${files.length} archivo(s) agregado(s) como evidencia`);
            // In a real app, upload files and refresh the evidence tab
          }
        };
        input.click();
      }

      function sendCommunication() {
        // In a real app, this would open a modal to compose a message
        const message = prompt('Escribe el mensaje a enviar:');
        if (message) {
          setTimeout(() => {
            alert('Comunicación enviada exitosamente');
            addCommunicationEntry('Mensaje Manual', 'email', message);
          }, 1000);
        }
      }

      function addCommunicationEntry(title, type, content) {
        const communicationsTab = document.getElementById('communications');
        const newEntry = document.createElement('div');
        newEntry.className = 'communication-item';
        newEntry.innerHTML = `
          <div class="communication-header">
            <div>
              <span class="communication-type ${type}">${type === 'email' ? 'Email' : 'Notificación'}</span>
              <span class="ms-2 fw-bold">${title}</span>
            </div>
            <small class="text-muted">Ahora</small>
          </div>
          <p class="mb-0">${content}</p>
        `;
        
        // Insert at the beginning
        const firstItem = communicationsTab.querySelector('.communication-item');
        if (firstItem) {
          firstItem.parentNode.insertBefore(newEntry, firstItem);
        } else {
          communicationsTab.appendChild(newEntry);
        }
      }
    </script>
  </body>
</html>